<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ù…Ø¯Ù„ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ AR</title>
    
    <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ AR -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a2e;
        }
        
        /* ØµÙØ­Ù‡ Ù„ÙˆØ¯ÛŒÙ†Ú¯ */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            transition: opacity 0.8s ease;
        }
        
        #loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.2);
            border-top: 5px solid white;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin-bottom: 25px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            padding: 0 20px;
            margin-bottom: 10px;
        }
        
        .loading-subtext {
            font-size: 14px;
            opacity: 0.8;
            text-align: center;
            padding: 0 20px;
            margin-bottom: 20px;
        }
        
        .progress-container {
            width: 85%;
            max-width: 350px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 4px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fff, #e0e7ff);
            width: 0%;
            transition: width 0.4s ease;
            border-radius: 16px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-size: 16px;
            font-weight: 600;
        }
        
        .file-size-info {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 15px;
            text-align: center;
        }
        
        /* Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø±Ø§Ù‡Ù†Ù…Ø§ */
        #instruction {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85);
            color: white;
            padding: 15px 25px;
            border-radius: 30px;
            font-size: 15px;
            z-index: 1000;
            text-align: center;
            max-width: 85%;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            display: none;
            animation: slideDown 0.5s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
        
        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ */
        .controls {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .controls.visible {
            opacity: 1;
        }
        
        .control-btn {
            background: rgba(255, 255, 255, 0.95);
            border: none;
            border-radius: 50%;
            width: 55px;
            height: 55px;
            font-size: 22px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .control-btn:active {
            transform: scale(0.9);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }
        
        /* Ù¾ÛŒØ§Ù… Ø®Ø·Ø§ */
        #error-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(220, 53, 69, 0.95);
            color: white;
            padding: 25px 35px;
            border-radius: 20px;
            display: none;
            z-index: 10000;
            text-align: center;
            max-width: 85%;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            animation: popIn 0.3s ease;
        }
        
        @keyframes popIn {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        .error-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .error-text {
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- ØµÙØ­Ù‡ Ù„ÙˆØ¯ÛŒÙ†Ú¯ -->
    <div id="loading-screen">
        <div class="spinner"></div>
        <div class="loading-text" id="loading-title">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
        <div class="loading-subtext" id="loading-subtitle">Ù„Ø·ÙØ§Ù‹ ØµØ¨ÙˆØ± Ø¨Ø§Ø´ÛŒØ¯</div>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
            <div class="progress-text" id="progress-text">0%</div>
        </div>
        <div class="file-size-info">â³ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¯Ù„ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ (Ù…Ù…Ú©Ù† Ø§Ø³Øª Ú†Ù†Ø¯ Ù„Ø­Ø¸Ù‡ Ø·ÙˆÙ„ Ø¨Ú©Ø´Ø¯)</div>
    </div>
    
    <!-- Ù¾ÛŒØ§Ù… Ø±Ø§Ù‡Ù†Ù…Ø§ -->
    <div id="instruction">ğŸ“± Ø¯ÙˆØ±Ø¨ÛŒÙ† Ø±Ø§ Ø¨Ù‡ Ø³Ù…Øª ØªØµÙˆÛŒØ± Ù‡Ø¯Ù Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯</div>
    
    <!-- Ù¾ÛŒØ§Ù… Ø®Ø·Ø§ -->
    <div id="error-message">
        <div class="error-title">âš ï¸ Ø®Ø·Ø§</div>
        <div class="error-text" id="error-text"></div>
    </div>
    
    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ù†ØªØ±Ù„ -->
    <div class="controls" id="controls">
        <button class="control-btn" id="reset-btn" title="Ø±ÛŒØ³Øª">ğŸ”„</button>
        <button class="control-btn" id="info-btn" title="Ø±Ø§Ù‡Ù†Ù…Ø§">â„¹ï¸</button>
    </div>
    
    <!-- ØµØ­Ù†Ù‡ AR -->
    <a-scene
        mindar-image="imageTargetSrc: ./targets.mind; filterMinCF:0.001; filterBeta: 0.1; warmupTolerance: 10; missTolerance: 10"
        color-space="sRGB"
        renderer="colorManagement: true; physicallyCorrectLights: true; antialias: true; alpha: true"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false"
        embedded
        id="scene"
        loading-screen="enabled: false">
        
        <!-- Ø¯Ø§Ø±Ø§ÛŒÛŒâ€ŒÙ‡Ø§ Ø¨Ø§ ØªØ§ÛŒÙ…â€ŒØ§ÙˆØª Ø·ÙˆÙ„Ø§Ù†ÛŒâ€ŒØªØ± -->
        <a-assets timeout="120000">
            <a-asset-item id="avatarModel" src="./model.glb"></a-asset-item>
        </a-assets>
        
        <!-- Ù†ÙˆØ±Ù¾Ø±Ø¯Ø§Ø²ÛŒ Ø¨Ù‡ØªØ± -->
        <a-light type="ambient" intensity="0.9"></a-light>
        <a-light type="directional" intensity="0.6" position="2 2 1"></a-light>
        <a-light type="hemisphere" intensity="0.4" groundColor="#ffffff"></a-light>
        
        <!-- Ø¯ÙˆØ±Ø¨ÛŒÙ† -->
        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>
        
        <!-- Ù‡Ø¯Ù ØªØµÙˆÛŒØ±ÛŒ -->
        <a-entity mindar-image-target="targetIndex: 0">
            <!-- Ù…Ø¯Ù„ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ -->
            <a-gltf-model 
                id="model"
                rotation="0 0 0" 
                position="0 0 0" 
                scale="0.5 0.5 0.5" 
                src="#avatarModel"
                animation="property: rotation; to: 0 360 0; dur: 10000; easing: linear; loop: true"
                animation__scale="property: scale; to: 0.55 0.55 0.55; dur: 2000; dir: alternate; loop: true; easing: easeInOutSine"
                visible="false">
            </a-gltf-model>
            
            <!-- Ø­Ù„Ù‚Ù‡ Ù†ÙˆØ±ÛŒ -->
            <a-ring
                position="0 -0.1 0"
                rotation="-90 0 0"
                radius-inner="0.3"
                radius-outer="0.5"
                color="#667eea"
                opacity="0.4"
                animation="property: scale; to: 1.3 1.3 1.3; dur: 1500; dir: alternate; loop: true"
                visible="false"
                id="ring">
            </a-ring>
        </a-entity>
    </a-scene>
    
    <script>
        // Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø§ØµÙ„ÛŒ
        const loadingScreen = document.getElementById('loading-screen');
        const progressBar = document.getElementById('progress');
        const progressText = document.getElementById('progress-text');
        const loadingTitle = document.getElementById('loading-title');
        const loadingSubtitle = document.getElementById('loading-subtitle');
        const instruction = document.getElementById('instruction');
        const errorMessage = document.getElementById('error-message');
        const errorText = document.getElementById('error-text');
        const scene = document.getElementById('scene');
        const controls = document.getElementById('controls');
        const model = document.getElementById('model');
        const ring = document.getElementById('ring');
        
        let currentProgress = 0;
        let modelLoaded = false;
        let arReady = false;
        let targetVisible = false;
        
        // ØªØ§Ø¨Ø¹ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù¾Ø±ÙˆÚ¯Ø±Ø³
        function updateProgress(percent, status = '') {
            currentProgress = Math.min(Math.max(percent, 0), 100);
            progressBar.style.width = currentProgress + '%';
            progressText.textContent = Math.round(currentProgress) + '%';
            
            if (status) {
                loadingSubtitle.textContent = status;
            }
            
            // Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ
            if (currentProgress < 30) {
                loadingTitle.textContent = 'â³ Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„...';
            } else if (currentProgress < 60) {
                loadingTitle.textContent = 'ğŸ“¦ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ù…Ø¯Ù„...';
            } else if (currentProgress < 90) {
                loadingTitle.textContent = 'ğŸ¨ Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´...';
            } else if (currentProgress < 100) {
                loadingTitle.textContent = 'âœ¨ ØªÙ‚Ø±ÛŒØ¨Ø§Ù‹ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª...';
            } else {
                loadingTitle.textContent = 'âœ… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ø§Ù…Ù„ Ø´Ø¯!';
            }
        }
        
        // Ù†Ù…Ø§ÛŒØ´ Ø®Ø·Ø§
        function showError(message) {
            errorText.textContent = message;
            errorMessage.style.display = 'block';
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 7000);
        }
        
        // Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
        updateProgress(5, 'Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¯ÙˆØ±Ø¨ÛŒÙ†...');
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Assets
        const assets = document.querySelector('a-assets');
        let loadStartTime = Date.now();
        
        if (assets) {
            updateProgress(15, 'Ø´Ø±ÙˆØ¹ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§...');
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±ÙˆÚ¯Ø±Ø³ Ø¨Ø±Ø§ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ø²Ø±Ú¯
            const progressInterval = setInterval(() => {
                if (currentProgress < 70 && !modelLoaded) {
                    updateProgress(currentProgress + 2, 'Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø§Ù†Ù„ÙˆØ¯... (ÙØ§ÛŒÙ„ Ø­Ø¬ÛŒÙ… Ø§Ø³Øª)');
                }
            }, 500);
            
            assets.addEventListener('loaded', () => {
                clearInterval(progressInterval);
                const loadTime = ((Date.now() - loadStartTime) / 1000).toFixed(1);
                console.log(`âœ… Assets loaded in ${loadTime}s`);
                modelLoaded = true;
                updateProgress(75, 'ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯ âœ“');
                checkComplete();
            });
            
            assets.addEventListener('timeout', () => {
                clearInterval(progressInterval);
                console.error('âŒ Assets timeout');
                showError('Ø²Ù…Ø§Ù† Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ…Ø§Ù… Ø´Ø¯. Ù„Ø·ÙØ§Ù‹ Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.');
                updateProgress(0, 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ!');
            });
            
            assets.addEventListener('error', (e) => {
                clearInterval(progressInterval);
                console.error('âŒ Assets error:', e);
                showError('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§. Ù„Ø·ÙØ§Ù‹ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯ Ú©Ù‡ ÙØ§ÛŒÙ„ model.glb Ø¯Ø± Ù…Ø³ÛŒØ± ØµØ­ÛŒØ­ Ù‚Ø±Ø§Ø± Ø¯Ø§Ø±Ø¯.');
                updateProgress(0, 'Ø®Ø·Ø§!');
            });
        }
        
        // Ø¢Ù…Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ AR
        scene.addEventListener('loaded', () => {
            console.log('âœ… Scene loaded');
            updateProgress(85, 'Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ AR...');
        });
        
        scene.addEventListener('renderstart', () => {
            console.log('âœ… AR System ready');
            arReady = true;
            updateProgress(95, 'Ø³ÛŒØ³ØªÙ… AR Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª');
            checkComplete();
        });
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ø§ØªÙ…Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
        function checkComplete() {
            if (modelLoaded && arReady) {
                updateProgress(100, 'âœ… Ù‡Ù…Ù‡ Ú†ÛŒØ² Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª!');
                setTimeout(() => {
                    loadingScreen.classList.add('hidden');
                    instruction.style.display = 'block';
                    controls.classList.add('visible');
                    console.log('ğŸ‰ App ready!');
                }, 800);
            }
        }
        
        // ØªØ´Ø®ÛŒØµ Ù‡Ø¯Ù
        scene.addEventListener('targetFound', () => {
            console.log('ğŸ¯ Target found');
            targetVisible = true;
            instruction.textContent = 'âœ… Ù‡Ø¯Ù ÛŒØ§ÙØª Ø´Ø¯! Ù…Ø¯Ù„ Ø¯Ø± Ø­Ø§Ù„ Ù†Ù…Ø§ÛŒØ´ Ø§Ø³Øª';
            instruction.style.background = 'rgba(40, 167, 69, 0.9)';
            
            // Ù†Ù…Ø§ÛŒØ´ Ù…Ø¯Ù„ Ùˆ Ø­Ù„Ù‚Ù‡
            if (model) model.setAttribute('visible', 'true');
            if (ring) ring.setAttribute('visible', 'true');
        });
        
        scene.addEventListener('targetLost', () => {
            console.log('âŒ Target lost');
            targetVisible = false;
            instruction.textContent = 'ğŸ“± Ø¯ÙˆØ±Ø¨ÛŒÙ† Ø±Ø§ Ø¨Ù‡ Ø³Ù…Øª ØªØµÙˆÛŒØ± Ù‡Ø¯Ù Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯';
            instruction.style.background = 'rgba(0, 0, 0, 0.85)';
            
            // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù…Ø¯Ù„ Ùˆ Ø­Ù„Ù‚Ù‡
            if (model) model.setAttribute('visible', 'false');
            if (ring) ring.setAttribute('visible', 'false');
        });
        
        // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
        document.getElementById('reset-btn').addEventListener('click', () => {
            if (confirm('Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ ØµÙØ­Ù‡ Ø±Ø§ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯ØŸ')) {
                location.reload();
            }
        });
        
        document.getElementById('info-btn').addEventListener('click', () => {
            alert('ğŸ“± Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡:\n\n' +
                  '1ï¸âƒ£ Ø¯ÙˆØ±Ø¨ÛŒÙ† Ø±Ø§ Ø¨Ù‡ Ø³Ù…Øª ØªØµÙˆÛŒØ± Ù‡Ø¯Ù (QR Code/Marker) Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯\n\n' +
                  '2ï¸âƒ£ ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ Ù…Ø¯Ù„ Ø³Ù‡â€ŒØ¨Ø¹Ø¯ÛŒ Ø¸Ø§Ù‡Ø± Ø´ÙˆØ¯\n\n' +
                  '3ï¸âƒ£ Ù…Ø¯Ù„ Ø¨Ù‡ ØµÙˆØ±Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ù…ÛŒâ€ŒÚ†Ø±Ø®Ø¯ Ùˆ Ø­Ø±Ú©Øª Ù…ÛŒâ€ŒÚ©Ù†Ø¯\n\n' +
                  '4ï¸âƒ£ Ø¨Ø§ Ø¯Ùˆ Ø§Ù†Ú¯Ø´Øª Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù…Ø¯Ù„ Ø±Ø§ Ø¨Ø²Ø±Ú¯/Ú©ÙˆÚ†Ú© Ú©Ù†ÛŒØ¯\n\n' +
                  'âš ï¸ Ø§Ú¯Ø± Ù…Ø¯Ù„ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù†Ø´Ø¯:\n' +
                  'â€¢ ÙØ§ØµÙ„Ù‡ Ø¯ÙˆØ±Ø¨ÛŒÙ† Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯\n' +
                  'â€¢ Ù†ÙˆØ± Ù…Ø­ÛŒØ· Ø±Ø§ Ø¨Ù‡ØªØ± Ú©Ù†ÛŒØ¯\n' +
                  'â€¢ Ø§Ø² Ø¯Ú©Ù…Ù‡ ğŸ”„ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯');
        });
        
        // Ù‚Ø§Ø¨Ù„ÛŒØª Ø²ÙˆÙ… Ø¨Ø§ Ø¯Ùˆ Ø§Ù†Ú¯Ø´Øª
        let initialDistance = 0;
        let currentScale = 0.5;
        
        document.addEventListener('touchstart', (e) => {
            if (e.touches.length === 2 && targetVisible && model) {
                initialDistance = getDistance(e.touches[0], e.touches[1]);
            }
        });
        
        document.addEventListener('touchmove', (e) => {
            if (e.touches.length === 2 && targetVisible && model && initialDistance > 0) {
                e.preventDefault();
                const currentDistance = getDistance(e.touches[0], e.touches[1]);
                const scaleDelta = (currentDistance - initialDistance) * 0.001;
                currentScale = Math.max(0.2, Math.min(2, currentScale + scaleDelta));
                model.setAttribute('scale', `${currentScale} ${currentScale} ${currentScale}`);
                initialDistance = currentDistance;
            }
        }, { passive: false });
        
        function getDistance(touch1, touch2) {
            const dx = touch1.clientX - touch2.clientX;
            const dy = touch1.clientY - touch2.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }
        
        // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø±ÙØ±Ø´ Ø¨Ø§ Pull-to-refresh
        let startY = 0;
        document.addEventListener('touchstart', (e) => {
            startY = e.touches[0].clientY;
        });
        
        document.addEventListener('touchmove', (e) => {
            const y = e.touches[0].clientY;
            if (y > startY && window.scrollY === 0) {
                e.preventDefault();
            }
        }, { passive: false });
        
        // Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§Ù‡Ø§ÛŒ Ú©Ù„ÛŒ
        window.addEventListener('error', (e) => {
            console.error('ğŸ’¥ Runtime error:', e);
        });
        
        // Ø­Ø°Ù ØªØ§ÛŒÙ…â€ŒØ§ÙˆØª - Ø§Ø¬Ø§Ø²Ù‡ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø§Ù…Ø­Ø¯ÙˆØ¯
        console.log('ğŸš€ AR App initialized - Large file mode enabled');
    </script>
</body>
</html>
